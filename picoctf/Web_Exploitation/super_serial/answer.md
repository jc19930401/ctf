http://mercury.picoctf.net:3449/index.php (hints says that flag is in ../flag)

First, use dirb to see is any sub page under mercury.picoctf.net:3449
We can found two site by dirb default library:
```
robots.txt
index.php
```

<img width="549" alt="截圖 2022-02-25 上午8 10 38" src="https://user-images.githubusercontent.com/37798944/155666267-51ad6583-9c13-4084-8f38-10290aed74ff.png">


The robots.txt give a hints, 

<img width="489" alt="截圖 2022-02-25 上午8 11 10" src="https://user-images.githubusercontent.com/37798944/155666613-8da873ef-02a8-47a4-8169-f666abfc2ae3.png">


maybe there are some subpage that extension is .phps, so we use
```
$dirb http://mercury.picoctf.net:3449/ -X .phps 
```

to scan again. Will find there are three files used .phps:
```
index.phps
cookies.phps
authentication.phps
```

<img width="621" alt="截圖 2022-02-25 下午3 13 35" src="https://user-images.githubusercontent.com/37798944/155671224-b33dd627-0ab0-488a-9f67-5f5ad6b09865.png">



Both index.php and authentication.php are require cookied.php, and we can see index.php setcookie "login" that used serialize!!
```
lencode(base64_encode(serialize($perm_res))) 
```

<img width="707" alt="截圖 2022-02-25 下午2 44 59" src="https://user-images.githubusercontent.com/37798944/155667726-69367494-4a6a-43a4-be13-fa8569d2cfc3.png">

And in cookies.php, it used unserialize.

<img width="662" alt="截圖 2022-02-25 下午3 17 27" src="https://user-images.githubusercontent.com/37798944/155671709-8fdfd0f4-b7fe-464f-a2d8-3a6db481417c.png">


In authentication.php we can see the class access_log used the MAGIC FUNCTION to_String! 
And it will call read_log function, then return the $log_file value.
So, try to show the flag by using this MAGIC FUNCTION!

<img width="571" alt="截圖 2022-02-25 下午4 12 03" src="https://user-images.githubusercontent.com/37798944/155679185-2f9e1d39-e31b-46a4-88f6-35b025897da6.png">


Create serialize object
```
O:10:"access_log":1{S:8:"log_file";S:7:"../flag";}
```

